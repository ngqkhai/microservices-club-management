{
  "info": {
    "name": "US-014 Join Event API",
    "description": "Simple Postman collection for testing Join Event API with API Gateway",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3003"
    },
    {
      "key": "event_id", 
      "value": "68679f77833b845eb9504008"
    },
    {
      "key": "user_id",
      "value": "123e4567-e89b-12d3-a456-426614174000"
    },
    {
      "key": "user_email",
      "value": "test@example.com"
    }
  ],
  "item": [
    {
      "name": "1. Join Event - Success (200)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status is 200', () => pm.response.to.have.status(200));",
              "pm.test('Message is correct', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json.message).to.equal('Joined event successfully');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "x-user-id",
            "value": "{{user_id}}"
          },
          {
            "key": "x-user-role",
            "value": "USER"
          },
          {
            "key": "x-user-email", 
            "value": "{{user_email}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/api/events/{{event_id}}/join"
      }
    },
    {
      "name": "2. Join Event - Already Joined (400)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status is 400', () => pm.response.to.have.status(400));",
              "pm.test('Error code is ALREADY_JOINED', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json.error).to.equal('ALREADY_JOINED');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "x-user-id",
            "value": "{{user_id}}"
          },
          {
            "key": "x-user-role",
            "value": "USER"
          },
          {
            "key": "x-user-email",
            "value": "{{user_email}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/api/events/{{event_id}}/join"
      }
    },
    {
      "name": "3. Join Event - Event Not Found (404)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status is 404', () => pm.response.to.have.status(404));",
              "pm.test('Error code is EVENT_NOT_FOUND', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json.error).to.equal('EVENT_NOT_FOUND');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "x-user-id",
            "value": "{{user_id}}"
          },
          {
            "key": "x-user-role",
            "value": "USER"
          },
          {
            "key": "x-user-email",
            "value": "{{user_email}}"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/api/events/nonexistent-id/join"
      }
    },
    {
      "name": "4. Join Event - No Authentication (401)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status is 401', () => pm.response.to.have.status(401));",
              "pm.test('Auth required message', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json.message).to.include('Authentication');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/api/events/{{event_id}}/join"
      }
    },
    {
      "name": "5. Join Event - Different User",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status is 200', () => pm.response.to.have.status(200));",
              "pm.test('Different user can join', () => {",
              "    const json = pm.response.json();",
              "    pm.expect(json.message).to.equal('Joined event successfully');",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "x-user-id",
            "value": "123e4567-e89b-12d3-a456-426614174001"
          },
          {
            "key": "x-user-role",
            "value": "USER"
          },
          {
            "key": "x-user-email",
            "value": "user2@example.com"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/api/events/{{event_id}}/join"
      }
    }
  ]
}
