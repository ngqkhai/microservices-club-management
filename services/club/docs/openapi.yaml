openapi: 3.0.3
info:
  title: Club Management System - Club Service API
  description: API documentation for the Club Service in the Club Management System
  version: 1.0.0
  contact:
    name: Club Management System Team
    url: https://github.com/club-management-system
servers:
  - url: /api
    description: Base API path
tags:
  - name: Clubs
    description: Club management operations
  - name: Recruitments
    description: Club recruitment operations
  - name: Members
    description: Club membership operations

paths:
  /clubs:
    get:
      tags:
        - Clubs
      summary: Get all clubs
      description: Retrieves a list of clubs with optional filtering
      parameters:
        - name: name
          in: query
          description: Filter clubs by name (case-insensitive)
          required: false
          schema:
            type: string
        - name: type
          in: query
          description: Filter clubs by type
          required: false
          schema:
            type: string
            enum: [ACADEMIC, SPORTS, CULTURAL, PROFESSIONAL]
        - name: status
          in: query
          description: Filter clubs by status
          required: false
          schema:
            type: string
            enum: [ACTIVE, INACTIVE]
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Number of results per page
          required: false
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClubList'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    post:
      tags:
        - Clubs
      summary: Create a new club
      description: Creates a new club in the system
      security:
        - BearerAuth: []
      requestBody:
        description: Club creation data
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClubCreate'
      responses:
        '201':
          description: Club created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClubDetail'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Duplicate club name
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /clubs/{id}:
    get:
      tags:
        - Clubs
      summary: Get a club by ID
      description: Retrieves detailed information about a specific club
      parameters:
        - name: id
          in: path
          description: ID of the club to retrieve
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClubDetail'
        '404':
          description: Club not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /clubs/{id}/recruitments:
    get:
      tags:
        - Recruitments
      summary: Get club recruitments
      description: Retrieves all recruitment rounds for a specific club
      parameters:
        - name: id
          in: path
          description: ID of the club
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/RecruitmentRound'
        '404':
          description: Club not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /clubs/{id}/members:
    post:
      tags:
        - Members
      summary: Add club member
      description: Adds a new member to a club
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the club
          required: true
          schema:
            type: string
      requestBody:
        description: Member data
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MemberCreate'
      responses:
        '201':
          description: Member added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '403':
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Club not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /clubs/{id}/members/{userId}:
    delete:
      tags:
        - Members
      summary: Remove club member
      description: Removes a member from a club
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the club
          required: true
          schema:
            type: string
        - name: userId
          in: path
          description: ID of the user to remove
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Member removed successfully
        '403':
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Club or member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
    put:
      tags:
        - Members
      summary: Update member role
      description: Updates the role of a member within a club
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the club
          required: true
          schema:
            type: string
        - name: userId
          in: path
          description: ID of the user
          required: true
          schema:
            type: string
      requestBody:
        description: Updated role data
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MemberRoleUpdate'
      responses:
        '200':
          description: Member role updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessMessage'
        '403':
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Club or member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    ClubList:
      type: object
      properties:
        total:
          type: integer
          description: Total number of clubs matching the filter criteria
          example: 2
        results:
          type: array
          items:
            $ref: '#/components/schemas/ClubSummary'
    
    ClubSummary:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the club
          example: '60d0fe4f5311236168a109ca'
        name:
          type: string
          description: Name of the club
          example: 'Science Club'
        type:
          type: string
          description: Type of club
          enum: [ACADEMIC, SPORTS, CULTURAL, PROFESSIONAL]
          example: 'ACADEMIC'
        status:
          type: string
          description: Status of the club
          enum: [ACTIVE, INACTIVE]
          example: 'ACTIVE'
        logo_url:
          type: string
          description: URL to the club's logo image
          example: 'https://example.com/logo.png'
      required:
        - id
        - name
        - type
        - status
    
    ClubDetail:
      allOf:
        - $ref: '#/components/schemas/ClubSummary'
        - type: object
          properties:
            description:
              type: string
              description: Description of the club's purpose and activities
              example: 'A club for science enthusiasts'
            size:
              type: integer
              description: Number of members in the club
              example: 25
            website_url:
              type: string
              description: URL to the club's website
              example: 'https://scienceclub.example.com'
    
    ClubCreate:
      type: object
      properties:
        name:
          type: string
          description: Name of the club (must be unique)
          example: 'Arts Club'
        description:
          type: string
          description: Description of the club's purpose and activities
          example: 'A club for creative arts enthusiasts'
        type:
          type: string
          description: Type of club
          enum: [ACADEMIC, SPORTS, CULTURAL, PROFESSIONAL]
          example: 'CULTURAL'
        logo_url:
          type: string
          description: URL to the club's logo image
          example: 'https://example.com/arts-logo.png'
        website_url:
          type: string
          description: URL to the club's website
          example: 'https://artsclub.example.com'
      required:
        - name
        - type
    
    RecruitmentRound:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the recruitment round
          example: '60d0fe4f5311236168a109cd'
        title:
          type: string
          description: Title of the recruitment round
          example: 'Fall 2025 Recruitment'
        start_at:
          type: string
          format: date-time
          description: Start date of recruitment period
          example: '2025-09-01T00:00:00Z'
        status:
          type: string
          description: Status of recruitment
          enum: [OPEN, CLOSED, CANCELLED]
          example: 'OPEN'
      required:
        - id
        - title
        - start_at
        - status
    
    MemberCreate:
      type: object
      properties:
        user_id:
          type: string
          description: ID of the user to add as a member
          example: '60d0fe4f5311236168a109cf'
        role:
          type: string
          description: Role of the member
          enum: [MANAGER, MEMBER]
          example: 'MEMBER'
      required:
        - user_id
        - role
    
    MemberRoleUpdate:
      type: object
      properties:
        role:
          type: string
          description: Updated role of the member
          enum: [MANAGER, MEMBER]
          example: 'MANAGER'
      required:
        - role
    
    SuccessMessage:
      type: object
      properties:
        message:
          type: string
          description: Success message
          example: 'Operation completed successfully'
    
    Error:
      type: object
      properties:
        status:
          type: integer
          description: HTTP status code
          example: 400
        error:
          type: string
          description: Error code
          example: 'VALIDATION_ERROR'
        message:
          type: string
          description: Error message
          example: 'Name and type are required'
      required:
        - status
        - error
        - message
  
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
